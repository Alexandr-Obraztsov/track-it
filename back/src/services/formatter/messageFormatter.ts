/**
 * Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚Ñ‚ÐµÑ€ Ð´Ð»Ñ Ð²ÑÐµÑ… Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹
 * Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð²ÑÐµ ÑÑ‚Ñ€Ð¾ÐºÐ¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÑŽÑ‚ÑÑ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ
 * Ð¦ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·ÑƒÐµÑ‚ Ð»Ð¾ÐºÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÑŽ Ð¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ‚ÐµÐºÑÑ‚Ð¾Ð¼
 */
export class MessageFormatter {
	// ========== ÐžÐ¨Ð˜Ð‘ÐšÐ˜ Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐ« ==========
	
	static readonly ERRORS = {
		GENERAL: 'âŒ ÐžÑˆÐ¸Ð±ÐºÐ°',
		UNAVAILABLE: 'âŒ ÐÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾',
		NOT_FOUND: 'âŒ ÐÐµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾'
	}

	// ========== Ð£Ð¡ÐŸÐ•Ð¨ÐÐ«Ð• ÐžÐŸÐ•Ð ÐÐ¦Ð˜Ð˜ ==========
	
	static readonly SUCCESS = {
		COMPLETED: 'âœ… Ð“Ð¾Ñ‚Ð¾Ð²Ð¾',
		NEW_TASKS: (tasks: number) => `<b>âœ¨ Ð¡Ð¾Ð·Ð´Ð°Ð½Ñ‹ Ð½Ð¾Ð²Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ (${tasks}):</b>`,
		REGISTERED: 'âœ… Ð—Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½'
	}

	// ========== Ð˜ÐÐ¤ÐžÐ ÐœÐÐ¦Ð˜ÐžÐÐÐ«Ð• Ð¡ÐžÐžÐ‘Ð©Ð•ÐÐ˜Ð¯ ==========
	
	static readonly INFO = {
		PRIVATE_OK: 'Ð’ Ð»Ð¸Ñ‡Ð½Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÑÑ… Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð½Ðµ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ!',
		GROUPS_ONLY: 'âŒ Ð¢Ð¾Ð»ÑŒÐºÐ¾ Ð² Ð³Ñ€ÑƒÐ¿Ð¿Ð°Ñ…',
		UNKNOWN: 'âŒ ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾'
	}

	// ========== Ð¡ÐžÐžÐ‘Ð©Ð•ÐÐ˜Ð¯ Ð‘ÐžÐ¢Ð ==========
	
	static readonly BOT_MESSAGES = {
		WELCOME: 'ðŸŽ‰ ÐŸÑ€Ð¸Ð²ÐµÑ‚! Ð¯ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð¹ Ð±Ð¾Ñ‚ Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð·Ð°Ð´Ð°Ñ‡Ð°Ð¼Ð¸!',
		VOICE_INSTRUCTIONS: 'ðŸŽ™ï¸ ÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ!',
		NATURAL_SPEECH: 'âœ¨ Ð“Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚Ðµ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾!',
		ADMIN_OK: 'âœ… ÐŸÑ€Ð°Ð²Ð° Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð° ÐµÑÑ‚ÑŒ!',
		ADMIN_NEED: 'âš ï¸ ÐÑƒÐ¶Ð½Ñ‹ Ð¿Ñ€Ð°Ð²Ð° Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°',
		REGISTER_BUTTON: 'ðŸ‘¤ Ð—Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒÑÑ',
		PINNED: 'ðŸ“Œ Ð—Ð°ÐºÑ€ÐµÐ¿Ð»ÐµÐ½Ð¾!',
		ADMIN_THANKS: 'ðŸŽ‰ Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾!',
		ADMIN_FULL: 'Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽ Ð¿Ð¾Ð»Ð½Ð¾Ñ†ÐµÐ½Ð½Ð¾.',
		ADMIN_WELCOME_PINNED: 'ðŸŽ‰ ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð¾! ÐŸÑ€Ð°Ð²Ð° ÐµÑÑ‚ÑŒ.\nðŸ“Œ Ð—Ð°ÐºÑ€ÐµÐ¿Ð»ÐµÐ½Ð¾!',
		VOICE_NOT_FOUND: 'ÐÐµ Ð½Ð°ÑˆÐµÐ» Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ðµ ðŸ¤·â€â™‚ï¸',
		START_COMMAND: 'ÐŸÑ€Ð¸Ð²ÐµÑ‚! Ð¯ Ð±Ð¾Ñ‚ Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð·Ð°Ð´Ð°Ñ‡Ð°Ð¼Ð¸.\n\nðŸŽ™ï¸ ÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ðµ!',
		SERVER_WORKING: 'Ð¡ÐµÑ€Ð²ÐµÑ€ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚!',
		SYSTEM_MESSAGE: '[ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ]'
	}

	// ========== ÐŸÐ Ð˜Ð’Ð•Ð¢Ð¡Ð¢Ð’Ð˜Ð¯ ==========
	
	static readonly WELCOME = {
		NEW_MEMBER: (userTag: string) => `ðŸ‘‹ ÐŸÑ€Ð¸Ð²ÐµÑ‚, ${userTag}!\n\nâœ… Ð—Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½.\nðŸŽ™ï¸ ÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ðµ!`,
		AUTO_REGISTERED: (userTag: string) => `âœ… ${userTag} Ð·Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½!`
	}

	// ========== ÐŸÐ Ð•Ð¡Ð•Ð¢Ð« Ð£Ð’Ð•Ð”ÐžÐœÐ›Ð•ÐÐ˜Ð™ ==========
	
	static readonly NOTIFICATION_PRESETS = {
		INTERVALS: {
			'15m': '15 Ð¼Ð¸Ð½ÑƒÑ‚',
			'30m': '30 Ð¼Ð¸Ð½ÑƒÑ‚',
			'1h': '1 Ñ‡Ð°Ñ',
			'2h': '2 Ñ‡Ð°ÑÐ°',
			'3h': '3 Ñ‡Ð°ÑÐ°',
			'4h': '4 Ñ‡Ð°ÑÐ°',
			'6h': '6 Ñ‡Ð°ÑÐ¾Ð²',
			'12h': '12 Ñ‡Ð°ÑÐ¾Ð²',
			'1d': '1 Ð´ÐµÐ½ÑŒ',
			'3d': '3 Ð´Ð½Ñ',
			'1w': '1 Ð½ÐµÐ´ÐµÐ»Ñ'
		},
		PERSONAL_NAMES: {
			off: 'Ð’Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½Ñ‹',
			minimal: 'ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ðµ',
			standard: 'Ð¡Ñ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ñ‹Ðµ',
			frequent: 'Ð§Ð°ÑÑ‚Ñ‹Ðµ',
			maximum: 'ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ðµ'
		},
		PERSONAL_DESCRIPTIONS: {
			off: 'Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ñ‹',
			minimal: 'Ð¢Ð¾Ð»ÑŒÐºÐ¾ ÑÐ°Ð¼Ñ‹Ðµ Ð²Ð°Ð¶Ð½Ñ‹Ðµ Ð½Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ',
			standard: 'Ð¡Ð±Ð°Ð»Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð½Ð°Ð±Ð¾Ñ€ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ð¹',
			frequent: 'ÐœÐ½Ð¾Ð³Ð¾ Ð½Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ð¹ Ð´Ð»Ñ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾Ð³Ð¾ Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ',
			maximum: 'Ð’ÑÐµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ñ‹Ðµ Ð½Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ Ð´Ð»Ñ Ð¿Ð¾Ð»Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ñ'
		},
		GROUP_DESCRIPTIONS: {
			off: 'Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ñ‹',
			minimal: 'Ð¢Ð¾Ð»ÑŒÐºÐ¾ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡Ð½Ñ‹Ðµ Ð½Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ',
			standard: 'Ð£Ð¼ÐµÑ€ÐµÐ½Ð½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð½Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ð¹',
			frequent: 'ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð½Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ Ð´Ð»Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹',
			maximum: 'Ð’ÑÐµ Ð½Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ Ð´Ð»Ñ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð¾Ð²'
		}
	}

	// ========== Ð”ÐÐÐÐ«Ð• Ð”Ð›Ð¯ GEMINI ==========
	
	static readonly GEMINI_DATA = {
		USERS_ABSENT: 'ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‚',
		ROLES_ABSENT: 'Ð Ð¾Ð»Ð¸ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‚',
		TASKS_ABSENT: 'Ð—Ð°Ð´Ð°Ñ‡Ð¸ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‚',
		MEMBERS_ABSENT: 'Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‚',
		DEADLINE_NOT_SET: 'Ð½Ðµ ÑƒÐºÐ°Ð·Ð°Ð½',
		NOT_ASSIGNED: 'Ð½Ðµ Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð°',
		COMPLETED_YES: 'Ð´Ð°',
		COMPLETED_NO: 'Ð½ÐµÑ‚'
	}

	// ========== Ð’ÐÐ Ð˜ÐÐÐ¢Ð« Ð¢Ð•ÐšÐ¡Ð¢ÐžÐ’ ==========
	
	static readonly VARIANTS = {
		UNKNOWN: 'ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ð¹',
		NO_ROLE: 'Ð±ÐµÐ· Ñ€Ð¾Ð»Ð¸',
		PERSONAL: 'Ð›Ð¸Ñ‡Ð½Ð°Ñ',
		GROUP: 'Ð“Ñ€ÑƒÐ¿Ð¿Ð¾Ð²Ð°Ñ',
		COMPLETED: 'Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð°',
		IN_PROGRESS: 'Ð² Ñ€Ð°Ð±Ð¾Ñ‚Ðµ',
		OVERDUE: 'ðŸ”´ ÐŸÑ€Ð¾ÑÑ€Ð¾Ñ‡ÐµÐ½Ð°',
		TOMORROW: 'ðŸŸ¡ Ð—Ð°Ð²Ñ‚Ñ€Ð°',
		TASKS_EMPTY: 'Ð—Ð°Ð´Ð°Ñ‡ Ð½ÐµÑ‚'
	}

	// ========== ÐœÐÐžÐ–Ð•Ð¡Ð¢Ð’Ð•ÐÐÐ«Ð• Ð¤ÐžÐ ÐœÐ« ==========
	
	static readonly PLURAL = {
		MEMBER: {
			ONE: 'ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸Ðº',
			FEW: 'ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ°',
			MANY: 'ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¾Ð²'
		}
	}

	/**
	 * ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½ÑƒÑŽ Ñ„Ð¾Ñ€Ð¼Ñƒ ÑÐ»Ð¾Ð²Ð° Ð´Ð»Ñ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð°
	 */
	static getPluralForm(count: number, forms: { ONE: string; FEW: string; MANY: string }): string {
		const lastDigit = count % 10
		const lastTwoDigits = count % 100

		if (lastTwoDigits >= 11 && lastTwoDigits <= 19) {
			return forms.MANY
		}

		if (lastDigit === 1) {
			return forms.ONE
		}

		if (lastDigit >= 2 && lastDigit <= 4) {
			return forms.FEW
		}

		return forms.MANY
	}

	/**
	 * ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½ÑƒÑŽ Ñ„Ð¾Ñ€Ð¼Ñƒ Ð´Ð»Ñ ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¾Ð²
	 */
	static getMemberPlural(count: number): string {
		return this.getPluralForm(count, this.PLURAL.MEMBER)
	}

	// ========== Ð¡Ð¢ÐÐ¢Ð£Ð¡Ð« Ð—ÐÐ”ÐÐ§ ==========
	
	static readonly TASK_STATUS = {
		OVERDUE: 'ðŸ”´ ÐŸÑ€Ð¾ÑÑ€Ð¾Ñ‡ÐµÐ½Ð°',
		TOMORROW: 'ðŸŸ¡ Ð—Ð°Ð²Ñ‚Ñ€Ð°',
		COMPLETED: 'Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð°',
		IN_PROGRESS: 'Ð² Ñ€Ð°Ð±Ð¾Ñ‚Ðµ'
	}

	/**
	 * ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ñ‚ÐµÐºÑÑ‚ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ð·Ð°Ð´Ð°Ñ‡Ð¸
	 */
	static getTaskStatusText(isCompleted: boolean, deadline?: Date): string {
		if (isCompleted) {
			return this.TASK_STATUS.COMPLETED
		}
		
		if (deadline) {
			const now = new Date()
			const timeDiff = deadline.getTime() - now.getTime()
			
			if (timeDiff <= 0) {
				return this.TASK_STATUS.OVERDUE
			}
		}
		
		return this.TASK_STATUS.IN_PROGRESS
	}
}
